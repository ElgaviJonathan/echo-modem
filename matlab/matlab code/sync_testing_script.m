clear
clc
%%
sample_rate = 44100;
samples_per_symbol = 256;
symbol_length_t = samples_per_symbol/sample_rate;

sync_freq = 6000;


% generate_freq_vector(64,5000,10000, 150);
freq_vec = [5023	5101	5171	5237	5297	5351	5419	5503	5581	5659	5737	5807	5869	5927	6011	6079	6143	6217	6301	6367	6427	6491	6553	6619	6679	6737	6803	6883	6961	7043	7121	7187	7253	7309	7393	7459	7537	7607	7687	7759	7823	7883	7951	8017	8093	8167	8233	8297	8377	8461	8543	8609	8681	8747	8807	8867	8941	9007	9067	9151	9221	9283	9349	9421]';
gold_code_seq_4096 = [-1	-1	-1	1	-1	-1	-1	-1	1	1	1	1	-1	-1	-1	-1	-1	-1	1	-1	-1	1	-1	-1	1	1	1	-1	-1	1	-1	-1	-1	-1	1	-1	-1	1	-1	1	-1	1	-1	-1	1	-1	1	1	-1	-1	-1	1	-1	-1	1	-1	1	1	1	1	-1	1	-1	1	-1	-1	1	-1	1	1	-1	1	-1	-1	1	1	1	-1	-1	1	1	1	-1	-1	1	1	-1	-1	-1	1	-1	1	1	1	-1	-1	-1	1	-1	-1	1	-1	-1	-1	-1	1	1	-1	1	-1	1	1	1	-1	1	-1	-1	1	1	1	-1	1	1	1	1	1	1	-1	-1	1	-1	1	-1	1	1	1	-1	-1	-1	-1	-1	1	-1	1	1	-1	-1	-1	1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	-1	1	-1	-1	-1	1	1	-1	-1	1	-1	1	-1	1	-1	-1	1	1	-1	1	1	-1	1	1	1	-1	1	1	1	-1	-1	1	-1	1	-1	-1	-1	1	-1	-1	-1	1	1	1	-1	1	1	-1	-1	1	1	1	-1	-1	1	-1	-1	1	1	-1	-1	-1	1	-1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	1	-1	1	1	1	-1	-1	-1	1	1	1	-1	1	1	1	-1	-1	1	1	1	1	1	1	-1	-1	1	1	1	1	-1	1	-1	1	-1	-1	1	-1	1	-1	-1	1	-1	1	-1	-1	-1	-1	1	1	-1	1	1	-1	1	-1	-1	1	-1	1	1	-1	-1	-1	-1	1	-1	-1	-1	1	1	-1	1	-1	1	1	-1	1	1	1	1	-1	1	-1	1	-1	-1	-1	1	-1	1	1	-1	1	-1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	-1	1	1	-1	-1	-1	-1	-1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	1	1	-1	1	1	-1	1	1	1	1	-1	-1	1	-1	1	-1	1	1	1	-1	-1	-1	1	1	1	1	-1	1	-1	-1	1	1	-1	-1	-1	-1	-1	-1	-1	-1	-1	1	1	1	1	-1	1	-1	-1	1	1	-1	1	-1	1	-1	-1	-1	-1	1	1	-1	-1	-1	1	1	1	1	-1	-1	1	1	-1	-1	-1	1	-1	1	-1	1	1	1	1	1	1	1	-1	1	-1	1	-1	1	-1	1	-1	-1	-1	1	-1	1	1	-1	-1	1	-1	1	-1	1	1	1	-1	1	1	-1	1	-1	-1	-1	-1	1	-1	-1	1	-1	1	1	1	1	-1	-1	1	1	-1	1	-1	1	1	-1	-1	-1	-1	-1	1	1	1	-1	1	-1	1	1	1	-1	-1	1	1	1	1	-1	-1	1	1	1	-1	1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	-1	-1	-1	1	1	-1	1	1	1	-1	1	-1	-1	1	1	1	1	-1	-1	-1	-1	-1	1	1	-1	-1	-1	1	-1	1	1	-1	-1	1	1	-1	1	1	-1	-1	1	1	1	-1	1	-1	-1	-1	-1	-1	-1	-1	-1	-1	-1	1	-1	-1	-1	-1	-1	-1	1	-1	-1	1	-1	-1	1	-1	1	1	1	-1	1	-1	1	1	-1	-1	-1	1	-1	1	-1	1	1	1	-1	1	1	-1	1	1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	-1	-1	-1	1	-1	-1	-1	-1	-1	-1	1	-1	-1	1	-1	1	-1	1	1	1	-1	1	-1	1	-1	-1	-1	-1	1	1	-1	1	-1	-1	1	-1	1	-1	-1	-1	1	-1	1	-1	1	-1	-1	-1	1	1	1	1	-1	1	-1	1	-1	-1	1	1	-1	1	1	1	-1	-1	-1	1	1	1	1	-1	1	1	1	-1	-1	1	1	-1	-1	1	-1	1	-1	-1	1	-1	-1	-1	-1	-1	1	-1	1	1	-1	1	1	1	1	-1	-1	-1	1	1	1	1	-1	1	-1	1	-1	1	1	-1	1	1	1	1	1	-1	-1	-1	1	-1	1	1	-1	1	1	-1	-1	-1	-1	1	-1	-1	1	-1	1	-1	1	-1	-1	1	1	1	-1	1	-1	1	1	1	-1	1	1	-1	1	-1	-1	1	-1	1	-1	1	-1	-1	1	-1	1	-1	1	-1	-1	1	1	-1	1	-1	1	1	1	1	-1	1	1	1	1	1	-1	-1	1	-1	1	1	-1	1	1	-1	1	-1	1	-1	1	1	1	-1	1	1	1	-1	1	1	1	-1	-1	1	-1	1	-1	-1	1	-1	1	1	1	1	1	-1	-1	-1	-1	-1	-1	1	-1	1	1	-1	1	1	-1	-1	1	-1	-1	-1	1	1	1	-1	-1	1	1	1	-1	1	-1	-1	1	1	1	-1	1	1	-1	1	-1	1	1	-1	-1	1	-1	-1	1	1	1	-1	-1	1	1	-1	1	-1	1	-1	-1	-1	-1	1	-1	-1	1	1	-1	1	-1	-1	1	1	-1	1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	-1	-1	1	-1	1	-1	1	-1	1	-1	-1	1	-1	1	-1	-1	-1	1	-1	1	-1	1	1	-1	-1	-1	-1	1	-1	-1	1	1	1	-1	-1	1	-1	-1	-1	1	1	-1	1	1	-1	-1	-1	1	-1	-1	-1	1	1	-1	1	-1	-1	1	-1	-1	1	-1	1	-1	1	-1	1	1	1	-1	1	-1	1	-1	1	1	-1	1	-1	-1	1	1	-1	1	-1	1	1	-1	-1	1	1	-1	1	-1	1	-1	1	-1	1	1	1	-1	-1	1	-1	1	-1	1	1	-1	1	-1	1	1	-1	-1	1	-1	1	-1	-1	1	-1	-1	1	-1	-1	-1	-1	1	-1	1	-1	1	-1	1	1	-1	1	1	-1	1	-1	-1	1	1	1	1	-1	-1	1	1	-1	-1	-1	1	1	1	1	-1	1	1	-1	1	1	1	-1	1	1	1	1	1	-1	1	1	1	1	-1	-1	-1	-1	-1	-1	-1	-1	1	-1	1	1	1	1	1	1	-1	-1	-1	-1	1	1	1	-1	1	-1	-1	1	-1	1	-1	1	-1	-1	-1	-1	-1	1	1	-1	1	-1	-1	1	1	-1	-1	1	-1	1	-1	1	1	-1	1	-1	-1	1	-1	-1	-1	1	1	1	1	1	1	1	1	-1	-1	1	-1	-1	-1	1	-1	1	1	1	1	-1	1	1	-1	-1	1	-1	1	-1	1	-1	-1	1	1	1	1	-1	-1	1	1	1	-1	1	1	-1	-1	1	1	1	1	-1	-1	-1	-1	1	-1	1	1	1	-1	1	1	1	-1	-1	1	-1	-1	-1	1	1	1	-1	-1	1	1	-1	1	1	-1	1	1	1	1	1	-1	1	1	1	1	1	-1	1	-1	1	1	-1	-1	1	-1	-1	-1	-1	1	1	-1	-1	1	-1	-1	1	-1	1	1	1	-1	1	1	1	-1	-1	1	1	-1	1	1	1	-1	1	1	1	-1	1	-1	1	-1	-1	-1	1	-1	1	1	1	-1	-1	1	1	1	1	-1	-1	1	-1	-1	-1	-1	1	1	-1	-1	1	-1	1	-1	1	1	1	-1	1	-1	-1	-1	1	-1	-1	1	1	1	1	-1	-1	-1	-1	1	-1	1	1	-1	1	1	1	1	-1	1	1	-1	-1	-1	1	1	1	-1	1	1	-1	-1	1	1	1	1	1	-1	1	1	-1	1	-1	-1	1	-1	-1	1	-1	1	1	-1	-1	-1	1	1	-1	-1	1	-1	1	1	1	1	1	1	1	-1	-1	-1	-1	-1	-1	1	1	-1	-1	1	1	-1	-1	1	-1	1	1	-1	-1	-1	-1	1	-1	-1	-1	-1	1	-1	-1	1	-1	1	-1	-1	-1	1	-1	1	1	-1	1	1	1	1	-1	-1	-1	-1	-1	-1	-1	-1	1	1	-1	1	1	-1	-1	-1	-1	1	1	-1	1	-1	-1	-1	1	-1	-1	1	-1	1	-1	-1	-1	1	-1	-1	1	-1	-1	1	1	-1	1	-1	-1	-1	-1	-1	-1	1	1	1	-1	-1	1	1	-1	1	-1	-1	1	-1	-1	1	-1	-1	1	-1	1	-1	1	1	1	-1	1	-1	1	-1	-1	1	1	-1	1	1	-1	1	1	-1	1	-1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	1	1	1	-1	-1	-1	-1	-1	-1	-1	-1	1	-1	1	1	1	1	1	1	1	-1	-1	1	1	-1	-1	1	1	1	1	-1	-1	1	1	-1	-1	1	1	1	1	1	-1	-1	1	-1	-1	-1	-1	1	-1	-1	-1	1	-1	1	1	-1	1	-1	1	-1	-1	-1	1	-1	1	-1	-1	1	-1	1	-1	-1	-1	-1	-1	1	1	1	1	1	-1	1	1	-1	-1	1	1	-1	1	-1	-1	-1	1	1	-1	1	1	1	1	-1	1	1	-1	-1	1	1	1	1	-1	-1	1	1	1	1	1	1	-1	1	1	-1	1	1	1	1	1	-1	-1	-1	1	1	-1	-1	-1	1	1	-1	-1	-1	1	-1	1	1	-1	1	1	-1	-1	-1	1	1	-1	-1	-1	1	1	-1	1	1	-1	1	1	-1	-1	1	-1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	-1	-1	1	1	1	1	1	1	-1	-1	1	1	1	-1	1	-1	1	-1	1	-1	-1	1	1	1	1	1	-1	1	-1	1	1	-1	-1	1	1	1	1	1	1	1	1	-1	-1	-1	1	1	1	1	-1	-1	1	1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	1	-1	1	-1	1	1	-1	-1	-1	-1	1	1	1	1	1	1	-1	-1	1	-1	-1	-1	1	-1	1	-1	1	1	-1	-1	1	-1	-1	1	1	-1	-1	1	1	-1	-1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	1	1	1	-1	-1	1	-1	1	1	-1	-1	1	-1	1	1	-1	-1	-1	1	1	-1	1	1	1	-1	1	-1	-1	1	-1	1	-1	1	-1	1	1	1	1	1	-1	-1	-1	-1	1	1	1	-1	1	-1	-1	-1	1	1	1	-1	1	-1	1	-1	1	-1	1	1	1	-1	1	-1	1	-1	1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	-1	-1	1	1	-1	1	-1	-1	-1	1	-1	1	-1	1	-1	-1	1	1	-1	1	-1	1	-1	1	-1	1	-1	-1	1	-1	-1	-1	1	1	-1	-1	1	-1	-1	1	1	1	-1	1	-1	-1	1	1	-1	-1	1	1	-1	-1	-1	1	1	1	-1	-1	1	-1	-1	1	-1	-1	-1	-1	1	1	-1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	1	1	1	-1	1	1	-1	1	1	-1	-1	-1	1	1	-1	-1	-1	1	1	1	-1	-1	-1	1	1	-1	-1	-1	-1	-1	1	-1	-1	-1	1	-1	1	1	1	-1	1	1	1	-1	1	1	1	-1	1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	-1	1	1	1	-1	1	1	1	-1	1	-1	-1	-1	-1	1	-1	1	-1	1	-1	1	1	1	1	-1	-1	-1	1	-1	-1	1	1	-1	1	1	1	-1	-1	-1	-1	-1	-1	-1	1	1	1	-1	1	-1	-1	-1	1	-1	1	1	-1	-1	1	1	-1	1	-1	-1	1	-1	1	-1	-1	-1	-1	-1	-1	-1	1	1	1	1	-1	-1	1	1	-1	-1	1	1	1	-1	1	-1	-1	-1	-1	-1	1	-1	-1	1	-1	-1	-1	-1	1	-1	-1	1	-1	-1	-1	1	1	1	1	-1	-1	-1	-1	-1	-1	1	-1	1	-1	-1	-1	-1	1	1	-1	1	-1	-1	-1	-1	-1	1	-1	-1	-1	-1	-1	1	1	-1	1	1	-1	1	1	1	-1	1	1	-1	1	-1	1	1	-1	1	1	-1	-1	1	-1	-1	-1	-1	1	-1	1	-1	-1	1	-1	-1	1	1	1	-1	-1	-1	1	-1	1	-1	1	-1	-1	-1	-1	1	-1	1	-1	-1	1	-1	1	1	1	1	-1	-1	-1	1	-1	-1	1	1	-1	-1	-1	-1	1	1	-1	1	1	1	1	1	-1	1	1	1	1	1	1	-1	-1	-1	1	-1	-1	1	1	-1	1	1	1	1	-1	1	1	1	1	1	-1	-1	1	-1	1	-1	1	1	1	-1	1	1	1	-1	1	1	-1	-1	1	-1	-1	1	1	1	-1	1	1	1	1	1	-1	-1	-1	1	1	1	-1	-1	-1	-1	-1	1	-1	1	1	1	-1	1	1	1	-1	-1	1	1	-1	-1	-1	-1	1	1	-1	-1	1	-1	-1	-1	-1	1	-1	1	-1	1	-1	1	1	-1	-1	-1	-1	-1	-1	-1	1	-1	1	1	-1	-1	1	1	1	1	1	1	-1	-1	1	1	-1	-1	1	-1	-1	-1	-1	1	-1	-1	1	-1	1	1	1	-1	-1	1	1	1	-1	1	-1	-1	1	-1	1	1	1	-1	-1	-1	-1	-1	1	1	1	-1	-1	1	-1	-1	-1	-1	1	-1	1	1	-1	1	1	1	1	-1	1	-1	-1	-1	-1	1	-1	1	-1	1	1	1	-1	-1	-1	-1	-1	1	1	-1	1	-1	1	-1	1	-1	-1	1	-1	-1	1	1	-1	-1	1	-1	-1	1	1	-1	1	-1	1	-1	1	1	1	1	-1	-1	-1	-1	1	-1	-1	1	-1	-1	1	1	1	1	1	-1	-1	1	1	1	1	-1	-1	1	1	-1	-1	1	1	-1	-1	1	1	-1	1	1	-1	1	-1	-1	1	-1	-1	-1	-1	-1	1	-1	1	-1	-1	1	-1	-1	-1	-1	-1	1	1	1	1	1	-1	1	-1	-1	1	-1	1	-1	-1	1	1	1	-1	-1	1	1	-1	-1	-1	1	-1	1	-1	-1	1	1	-1	-1	1	1	1	-1	-1	1	-1	-1	-1	1	-1	-1	-1	1	1	-1	1	1	1	-1	1	-1	-1	-1	1	-1	-1	1	-1	-1	-1	1	-1	-1	-1	1	-1	1	1	1	-1	-1	1	1	-1	1	1	-1	1	-1	1	1	1	-1	-1	-1	-1	1	1	-1	-1	1	-1	1	1	-1	1	1	1	1	1	1	1	1	-1	-1	1	-1	1	1	-1	1	-1	-1	1	1	-1	1	-1	-1	-1	1	-1	1	-1	1	1	1	1	1	-1	1	1	-1	-1	1	-1	-1	1	-1	-1	-1	1	1	-1	1	-1	-1	1	1	1	1	1	-1	1	-1	-1	-1	1	1	1	1	1	1	-1	-1	-1	1	-1	1	1	-1	-1	1	-1	1	1	1	-1	-1	1	-1	-1	-1	1	1	1	1	1	-1	-1	-1	-1	1	1	1	1	-1	-1	1	-1	-1	-1	1	-1	1	-1	1	1	1	-1	1	1	1	1	1	1	-1	-1	1	1	-1	-1	-1	1	-1	-1	-1	-1	-1	-1	-1	-1	1	1	-1	1	-1	-1	-1	-1	1	-1	-1	-1	-1	1	1	1	1	-1	-1	-1	-1	1	-1	-1	-1	1	1	1	1	-1	-1	-1	1	1	-1	-1	-1	1	-1	-1	-1	1	1	-1	1	-1	1	-1	1	-1	1	1	-1	-1	1	1	1	-1	-1	-1	1	1	1	-1	-1	1	-1	1	1	1	-1	1	1	1	-1	1	-1	1	1	1	-1	-1	-1	1	-1	-1	1	1	-1	-1	1	-1	1	-1	1	-1	1	-1	-1	-1	1	-1	1	-1	-1	1	-1	-1	-1	1	1	-1	-1	-1	1	1	1	-1	1	-1	-1	1	1	1	-1	1	-1	1	-1	-1	1	1	1	-1	1	-1	-1	-1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	-1	1	-1	1	1	1	-1	1	1	-1	-1	1	1	-1	-1	-1	-1	1	-1	-1	-1	1	-1	-1	1	-1	-1	1	1	-1	1	-1	1	-1	1	1	1	1	1	-1	1	1	1	1	1	1	-1	1	1	1	-1	1	-1	-1	-1	-1	-1	1	-1	1	-1	1	-1	1	1	1	-1	1	-1	1	-1	-1	1	1	-1	-1	-1	-1	1	1	1	1	1	1	1	-1	-1	1	1	-1	1	-1	-1	1	1	1	-1	1	-1	1	-1	1	-1	1	1	-1	-1	1	-1	-1	1	1	1	1	-1	1	1	1	1	1	1	-1	1	1	-1	-1	1	-1	1	-1	-1	-1	1	1	1	1	1	-1	-1	1	1	1	-1	-1	1	1	-1	1	-1	1	-1	1	1	1	-1	1	-1	1	-1	-1	-1	-1	-1	-1	-1	-1	1	1	1	-1	1	1	-1	-1	-1	-1	-1	1	1	1	1	1	1	-1	1	1	-1	1	1	1	-1	1	1	-1	1	1	1	-1	1	-1	1	1	1	1	-1	-1	1	-1	-1	1	1	1	1	-1	1	1	1	1	1	1	1	1	1	1	-1	-1	1	-1	1	-1	-1	-1	1	1	1	1	-1	1	1	-1	-1	-1	1	1	-1	1	1	-1	-1	-1	1	-1	-1	-1	1	-1	-1	1	-1	1	-1	-1	1	-1	1	1	-1	1	1	-1	-1	-1	1	1	-1	1	-1	1	-1	-1	-1	1	1	1	-1	-1	1	-1	1	1	1	-1	1	-1	1	1	1	1	1	-1	-1	1	1	-1	1	-1	1	1	-1	1	-1	1	1	1	-1	1	-1	1	1	1	1	-1	-1	1	1	1	-1	-1	1	-1	-1	-1	-1	-1	-1	1	1	1	-1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	-1	1	1	-1	-1	1	1	-1	-1	1	-1	-1	1	-1	1	1	-1	-1	1	-1	-1	-1	-1	-1	-1	-1	1	1	1	1	1	-1	-1	1	1	1	1	-1	-1	1	-1	1	1	-1	-1	1	1	-1	1	1	-1	1	1	-1	-1	1	1	1	-1	-1	1	1	-1	1	-1	-1	-1	1	1	1	-1	-1	1	1	1	-1	-1	1	1	1	-1	1	1	-1	-1	1	1	1	1	1	1	-1	-1	1	-1	-1	-1	1	1	-1	-1	-1	-1	-1	1	1	1	1	-1	-1	1	1	-1	-1	1	1	1	-1	1	-1	-1	1	1	1	-1	-1	-1	1	-1	-1	1	-1	-1	-1	1	1	-1	-1	-1	1	1	-1	-1	1	-1	-1	1	-1	-1	-1	-1	1	1	-1	-1	1	-1	-1	-1	-1	-1	-1	1	-1	-1	1	1	-1	1	-1	1	-1	-1	-1	1	1	-1	1	-1	-1	-1	-1	1	1	-1	-1	1	1	-1	1	1	1	1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	1	1	1	-1	1	1	1	1	-1	1	1	1	-1	-1	1	-1	-1	-1	1	-1	1	1	-1	-1	1	-1	1	1	-1	-1	-1	1	1	-1	1	1	-1	-1	1	-1	1	-1	1	1	1	1	1	-1	1	-1	-1	-1	1	-1	-1	1	-1	-1	-1	-1	-1	1	1	-1	-1	-1	-1	1	-1	-1	1	1	1	1	1	-1	-1	1	1	-1	-1	1	1	1	1	-1	-1	1	1	-1	1	-1	1	-1	1	1	-1	-1	1	-1	1	1	1	1	-1	-1	1	1	1	1	1	-1	-1	-1	-1	1	-1	1	-1	-1	-1	1	-1	1	1	1	-1	1	-1	1	1	1	1	1	-1	1	1	1	-1	-1	-1	1	1	1	1	1	-1	-1	-1	-1	1	-1	-1	-1	1	1	1	-1	1	1	-1	-1	1	1	-1	-1	1	1	1	1	1	1	1	-1	1	1	1	1	-1	1	1	-1	1	1	1	1	-1	-1	-1	1	-1	-1	1	1	-1	-1	1	1	-1	-1	-1	-1	1	-1	-1	-1	1	1	1	-1	-1	1	1	-1	1	1	1	-1	-1	1	-1	1	1	1	1	-1	-1	-1	1	-1	-1	-1	1	1	-1	1	1	-1	1	1	1	-1	-1	1	1	1	-1	-1	-1	1	-1	1	-1	-1	-1	-1	-1	-1	1	-1	1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	-1	-1	-1	-1	-1	1	-1	1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	-1	1	-1	1	-1	1	1	-1	1	1	-1	1	1	1	1	-1	-1	-1	1	1	1	-1	-1	-1	-1	-1	1	1	-1	-1	1	1	-1	1	1	-1	-1	1	-1	-1	-1	-1	1	1	-1	-1	1	-1	1	-1	-1	1	-1	1	1	-1	1	-1	-1	-1	1	-1	1	-1	-1	-1	-1	-1	1	-1	1	1	1	-1	-1	-1	1	1	-1	1	-1	1	1	1	1	-1	-1	-1	1	-1	1	-1	1	1	1	-1	1	1	-1	1	-1	-1	1	-1	-1	-1	1	-1	-1	1	-1	1	-1	1	-1	1	1	-1	1	1	1	1	1	1	-1	1	1	1	-1	1	-1	-1	-1	1	-1	1	-1	1	-1	1	-1	1	1	-1	1	1	-1	1	1	-1	1	-1	1	1	-1	-1	-1	-1	1	-1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	-1	-1	1	-1	-1	1	1	1	-1	-1	1	1	-1	1	1	-1	-1	-1	-1	-1	1	-1	1	1	1	-1	-1	1	1	-1	-1	-1	1	1	1	1	1	1	1	-1	1	1	-1	1	-1	1	1	1	1	-1	1	1	1	-1	-1	-1	1	1	1	-1	1	-1	1	-1	-1	1	1	1	-1	-1	1	1	1	-1	1	1	-1	1	1	1	1	1	1	-1	-1	1	1	1	-1	1	1	-1	-1	1	1	1	1	-1];
gold_code_seq_500 = [1	-1	1	-1	-1	-1	1	-1	1	1	1	-1	-1	1	-1	1	-1	-1	1	-1	-1	-1	-1	-1	1	-1	1	-1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	1	1	-1	1	-1	-1	1	1	1	1	1	-1	1	1	1	-1	-1	-1	-1	1	-1	-1	-1	-1	-1	-1	-1	1	-1	1	-1	-1	1	1	1	1	-1	-1	-1	-1	-1	-1	-1	-1	1	1	1	1	1	-1	1	1	1	1	1	-1	1	-1	1	-1	-1	1	-1	-1	1	1	1	-1	-1	1	-1	1	-1	-1	-1	-1	1	-1	1	-1	1	1	-1	-1	-1	1	1	-1	-1	-1	-1	1	1	1	1	1	-1	1	1	1	1	-1	1	1	-1	-1	-1	-1	-1	-1	-1	1	1	-1	1	-1	-1	1	1	-1	-1	1	1	1	1	1	-1	1	1	1	-1	1	1	1	1	1	-1	-1	1	1	-1	-1	1	1	-1	1	1	-1	1	-1	1	-1	1	1	1	1	-1	1	1	-1	-1	1	-1	1	-1	1	-1	-1	-1	-1	1	1	1	-1	1	-1	1	1	1	-1	1	-1	-1	1	-1	1	-1	-1	-1	1	1	1	-1	1	-1	1	-1	1	1	-1	-1	1	-1	1	1	-1	1	1	-1	1	-1	-1	-1	-1	-1	1	-1	-1	1	-1	1	1	1	-1	-1	-1	1	-1	1	1	1	1	1	1	1	-1	1	1	-1	1	-1	-1	-1	-1	-1	1	1	-1	1	1	-1	-1	-1	-1	1	-1	1	1	-1	-1	1	-1	1	-1	-1	1	-1	1	-1	1	1	1	1	1	-1	-1	1	1	-1	1	-1	1	1	-1	-1	-1	-1	-1	-1	1	1	1	1	-1	-1	1	1	1	-1	1	1	1	1	-1	1	1	-1	1	-1	1	1	-1	-1	-1	-1	-1	1	1	1	1	-1	-1	1	-1	1	1	-1	1	-1	-1	1	1	1	1	-1	-1	-1	-1	-1	-1	-1	-1	-1	-1	1	-1	-1	-1	-1	-1	1	-1	-1	-1	1	1	1	1	1	1	-1	-1	1	1	-1	-1	1	-1	1	1	1	1	-1	1	1	1	1	-1	-1	1	1	-1	1	1	1	-1	-1	1	-1	-1	1	-1	-1	1	1	1	-1	-1	-1	1	-1	-1	1	-1	-1	1	1	-1	-1	1	1	-1	1	-1	1	-1	-1	1	1	-1	-1	-1	-1	-1	1	1	-1	-1	1	1	1	-1	1	-1	-1	1	1	1	1	-1	-1	1	1	1	1	1	1	-1	1	-1	1	1	-1	-1	-1	-1	1	-1	-1	-1	1	-1];
gold_code_seq_250 = [-1	-1	-1	1	-1	1	-1	-1	1	1	1	-1	1	-1	1	1	1	-1	1	1	1	1	-1	-1	-1	-1	-1	1	-1	-1	-1	-1	1	1	1	1	1	1	1	1	-1	1	-1	-1	-1	-1	1	1	1	-1	-1	1	-1	1	-1	1	1	-1	-1	1	1	-1	-1	1	-1	-1	-1	1	1	1	-1	1	1	1	-1	1	1	1	-1	-1	-1	1	1	-1	-1	-1	-1	1	-1	1	1	1	-1	-1	-1	-1	-1	1	1	-1	-1	1	-1	1	1	-1	-1	1	1	1	1	-1	-1	-1	1	-1	1	1	-1	-1	1	1	-1	1	1	1	1	1	-1	-1	-1	1	1	1	-1	1	1	-1	-1	-1	-1	-1	1	1	1	1	1	1	1	-1	-1	-1	-1	-1	1	-1	1	1	-1	1	1	-1	-1	1	1	-1	-1	1	1	1	1	-1	-1	1	-1	1	-1	1	-1	-1	-1	1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	-1	1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	-1	-1	-1	1	1	-1	1	-1	1	1	-1	1	-1	1	1	-1	1	1	-1	-1	-1	-1	1	1	-1	-1	1	-1	1	-1	-1	1	-1	1	-1	1	1];
gold_code_seq_256 = [1	-1	-1	1	-1	1	-1	-1	-1	-1	1	1	-1	-1	1	1	-1	1	-1	1	-1	1	1	1	1	1	-1	1	-1	1	1	-1	-1	1	-1	1	1	-1	-1	1	-1	-1	1	1	-1	-1	-1	1	1	1	-1	1	1	1	-1	1	-1	1	1	1	-1	-1	1	-1	-1	1	-1	1	-1	1	1	-1	1	-1	1	1	-1	-1	-1	-1	1	1	1	-1	1	1	-1	1	-1	1	-1	-1	-1	-1	1	1	1	-1	-1	-1	1	-1	1	1	-1	1	1	1	1	-1	-1	-1	-1	1	-1	1	1	-1	-1	1	1	-1	1	1	1	-1	-1	-1	-1	1	1	-1	-1	1	1	-1	1	1	1	1	-1	-1	-1	-1	1	-1	-1	-1	1	1	1	-1	1	-1	-1	-1	-1	-1	-1	1	1	-1	-1	1	1	1	-1	-1	1	1	-1	1	1	-1	1	-1	1	-1	-1	1	-1	-1	1	1	1	-1	-1	-1	-1	-1	-1	1	-1	-1	-1	1	-1	-1	-1	-1	1	-1	-1	1	1	-1	1	1	-1	1	-1	-1	1	1	1	1	-1	1	1	-1	1	-1	1	1	1	1	1	1	1	-1	1	-1	-1	1	-1	1	-1	-1	-1	-1	-1	1	-1	1	-1	-1	1	-1	-1	1	1	1	-1	1	-1	-1];
gold_code_seq_100 = [-1	1	1	1	1	1	-1	-1	1	-1	1	-1	-1	-1	-1	-1	-1	-1	1	-1	1	-1	-1	1	1	1	1	1	1	1	-1	1	1	1	1	-1	1	1	-1	-1	-1	-1	1	1	1	-1	-1	1	1	-1	-1	-1	1	-1	-1	-1	1	-1	1	1	-1	-1	1	-1	1	-1	1	-1	1	-1	-1	-1	1	1	1	-1	-1	-1	1	1	-1	1	-1	-1	1	-1	1	-1	1	-1	-1	1	1	1	-1	1	-1	-1	-1	1];
% 
sync_bits = (gold_code_seq_256+1)/2;
mod_order = 16;
sync_bits_per_symbol = log2(mod_order);
reshape(sync_bits,sync_bits_per_symbol,[]);
sync_symbols = (2.^(sync_bits_per_symbol-1:-1:0))*reshape(sync_bits,sync_bits_per_symbol,[]);
sync_sig_complex = fskmod(sync_symbols, mod_order, 200, samples_per_symbol, 44100);
t = (0:length(sync_sig_complex)-1)/sample_rate;
sync_sig = real(sync_sig_complex).*cos(2*pi*sync_freq*t) + imag(sync_sig_complex).*sin(2*pi*sync_freq*t);

% sync_bits = (gold_code_seq_4096+1)/2;
% sync_sig = multi_tone_fsk_modulator(sync_bits,64,freq_vec,sample_rate,symbol_length_t);
% sync_freq = freq_vec(1) + (freq_vec(end)-freq_vec(1))/2;
% t = (0:length(sync_sig)-1)/sample_rate;
% sync_sig_complex = sync_sig.*sin(2*pi*sync_freq*t)+1j*sync_sig.*cos(2*pi*sync_freq*t);

%%
[raw_rx_sig, rx_sample_freq] = audioread("recording_echo_sig_tx_sync_16fsk_6000_256s.wav");
raw_rx_sig = raw_rx_sig(:,1);

%% filter the signal
filtered_rx_sig = highpass(raw_rx_sig,4e3,sample_rate);

t = ((0:length(filtered_rx_sig)-1)/sample_rate)';
baseband_rx_sig = filtered_rx_sig.*cos(2*pi*sync_freq*t) + 1j*filtered_rx_sig.*sin(2*pi*sync_freq*t);
sign_sync_sig = sign(sync_sig);
sign_rx_sig = sign(filtered_rx_sig);

figure(1)
plot(conv(flip(sync_sig), filtered_rx_sig));

figure(2)
plot(abs(conv(flip(conj(sync_sig_complex)), baseband_rx_sig)));

figure(3)
plot(conv(flip(sign_sync_sig), filtered_rx_sig));

figure(4)
plot(conv(flip(sync_sig), sign_rx_sig));

figure(5)
plot(conv(flip(sign_sync_sig), sign_rx_sig));




%%
% audiowrite("matlab_direct_multi_tone_robust_fsk_sync_test.wav",test_sig,sample_rate);
%%
% [raw_rx_sig, rx_sample_freq] = audioread("recording_multi_tone_robust_fsk_sync_test.wav");

% plot(conv(flip(test_sig), raw_rx_sig(:,1)));


%% chirp sync
% sample_rate = 44100;
% chirp_sync_len = 0.05;
% t = (0:chirp_sync_len*sample_rate-1)/sample_rate;
% chirp_sync = chirp(t,5000,1,10000,"linear");
% padded_chirp_sync = [zeros(1,20000), chirp_sync];
%%
% audiowrite("C:\ToDATA\acoustic lock project\matlab\matlab code\audio recordings\matlab_direct_chirp_sync_test_005s.wav",padded_chirp_sync,sample_rate);

%%
% [raw_rx_sig, rx_sample_freq] = audioread("recording_echo_sig_tx_sync_005.wav");
% plot(conv(flip(chirp_sync), raw_rx_sig(:,1)));
% 
% figure()
% [raw_rx_sig, rx_sample_freq] = audioread("matlab_echo_sig_tx_sync_005.wav");
% plot(conv(flip(cw_sig), raw_rx_sig(:,1)));


